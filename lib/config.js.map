{"version":3,"sources":["../src/config.js"],"names":["os","require","path","process","fs","Config","constructor","globalConfigPath","join","homedir","globalConfig","_configRead","localConfig","isExists","stat","statSync","cwd","e","startLocal","localConfigPath","filePath","JSON","parse","readFileSync","_configWrite","config","writeFileSync","stringify","getLocal","key","getGlobal","getAuthor","author","name","email","homepage","url","writeLocal","value","writeGlobal","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,KAAKC,QAAQ,IAAR,CAAX;AACA,MAAMC,OAAOD,QAAQ,MAAR,CAAb;AACA,MAAME,UAAUF,QAAQ,SAAR,CAAhB;AACA,MAAMG,KAAKH,QAAQ,IAAR,CAAX;;AAEA,MAAMI,MAAN,CAAa;AACTC,kBAAc;AACV,aAAKC,gBAAL,GAAwBL,KAAKM,IAAL,CAAUR,GAAGS,OAAH,EAAV,EAAwB,kBAAxB,CAAxB;AACA,aAAKC,YAAL,GAAoB,KAAKC,WAAL,CAAiB,KAAKJ,gBAAtB,CAApB;AACA,aAAKK,WAAL,GAAmB,EAAnB;AACH;;AAEDC,eAAW;AACP,YAAI;AACA,kBAAMC,OAAOV,GAAGW,QAAH,CAAYb,KAAKM,IAAL,CAAUL,QAAQa,GAAR,EAAV,EAAyB,kBAAzB,CAAZ,CAAb;AACA,mBAAOF,QAAQ,OAAOA,IAAP,KAAgB,WAA/B;AACH,SAHD,CAGE,OAAOG,CAAP,EAAU;AACR,mBAAO,KAAP;AACH;AACJ;;AAEDC,iBAAa;AACT,aAAKC,eAAL,GAAuBjB,KAAKM,IAAL,CAAUL,QAAQa,GAAR,EAAV,EAAyB,kBAAzB,CAAvB;AACA,aAAKJ,WAAL,GAAmB,KAAKD,WAAL,CAAiB,KAAKQ,eAAtB,CAAnB;AACH;;AAEDR,gBAAYS,QAAZ,EAAsB;AAClB,YAAI;AACA,mBAAOC,KAAKC,KAAL,CAAWlB,GAAGmB,YAAH,CAAgBH,QAAhB,CAAX,CAAP;AACH,SAFD,CAEE,OAAOH,CAAP,EAAU;AACR,mBAAO,EAAP;AACH;AACJ;;AAEDO,iBAAaJ,QAAb,EAAuBK,MAAvB,EAA+B;AAC3BrB,WAAGsB,aAAH,CAAiBN,QAAjB,EAA4B,GAAEC,KAAKM,SAAL,CAAeF,MAAf,EAAuB,IAAvB,EAA6B,IAA7B,CAAmC,IAAjE;AACH;;AAEDG,aAASC,GAAT,EAAc;AACV,eAAO,KAAKjB,WAAL,CAAiBiB,GAAjB,CAAP;AACH;;AAEDC,cAAUD,GAAV,EAAe;AACX,eAAO,KAAKnB,YAAL,CAAkBmB,GAAlB,CAAP;AACH;;AAEDE,gBAAY;AACR,YAAI,KAAKrB,YAAL,CAAkBsB,MAAtB,EAA8B;AAC1B,mBAAO,KAAKtB,YAAL,CAAkBsB,MAAzB;AACH,SAFD,MAEO;AACH,kBAAMA,SAAS,EAAf;AACA,gBAAI,KAAKtB,YAAL,CAAkBuB,IAAtB,EAA4B;AACxBD,uBAAOC,IAAP,GAAc,KAAKvB,YAAL,CAAkBuB,IAAhC;AACH;AACD,gBAAI,KAAKvB,YAAL,CAAkBwB,KAAtB,EAA6B;AACzBF,uBAAOE,KAAP,GAAe,KAAKxB,YAAL,CAAkBwB,KAAjC;AACH;AACD,gBAAI,KAAKxB,YAAL,CAAkByB,QAAtB,EAAgC;AAC5BH,uBAAOI,GAAP,GAAa,KAAK1B,YAAL,CAAkByB,QAA/B;AACH;;AAED,mBAAOH,MAAP;AACH;AACJ;;AAEDK,eAAWR,GAAX,EAAgBS,KAAhB,EAAuB;AACnB,aAAK1B,WAAL,CAAiBiB,GAAjB,IAAwBS,KAAxB;AACA,aAAKd,YAAL,CAAkB,KAAKL,eAAvB,EAAwC,KAAKP,WAA7C;AACH;;AAED2B,gBAAYV,GAAZ,EAAiBS,KAAjB,EAAwB;AACpB,aAAK5B,YAAL,CAAkBmB,GAAlB,IAAyBS,KAAzB;AACA,aAAKd,YAAL,CAAkB,KAAKjB,gBAAvB,EAAyC,KAAKG,YAA9C;AACH;;AApEQ;;AAwEb,MAAMe,SAAS,IAAIpB,MAAJ,EAAf;;AAEAmC,OAAOC,OAAP,GAAiBhB,MAAjB","file":"config.js","sourcesContent":["'use strict'\n\nconst os = require('os')\nconst path = require('path')\nconst process = require('process')\nconst fs = require('fs')\n\nclass Config {\n    constructor() {\n        this.globalConfigPath = path.join(os.homedir(), '.waterslide.json')\n        this.globalConfig = this._configRead(this.globalConfigPath)\n        this.localConfig = {}\n    }\n\n    isExists() {\n        try {\n            const stat = fs.statSync(path.join(process.cwd(), '.waterslide.json'))\n            return stat && typeof stat !== 'undefined'\n        } catch (e) {\n            return false\n        }\n    }\n\n    startLocal() {\n        this.localConfigPath = path.join(process.cwd(), '.waterslide.json')\n        this.localConfig = this._configRead(this.localConfigPath)\n    }\n\n    _configRead(filePath) {\n        try {\n            return JSON.parse(fs.readFileSync(filePath))\n        } catch (e) {\n            return {}\n        }\n    }\n\n    _configWrite(filePath, config) {\n        fs.writeFileSync(filePath, `${JSON.stringify(config, null, '  ')}\\n`)\n    }\n\n    getLocal(key) {\n        return this.localConfig[key]\n    }\n\n    getGlobal(key) {\n        return this.globalConfig[key]\n    }\n\n    getAuthor() {\n        if (this.globalConfig.author) {\n            return this.globalConfig.author\n        } else {\n            const author = {}\n            if (this.globalConfig.name) {\n                author.name = this.globalConfig.name\n            }\n            if (this.globalConfig.email) {\n                author.email = this.globalConfig.email\n            }\n            if (this.globalConfig.homepage) {\n                author.url = this.globalConfig.homepage\n            }\n\n            return author\n        }\n    }\n\n    writeLocal(key, value) {\n        this.localConfig[key] = value\n        this._configWrite(this.localConfigPath, this.localConfig)\n    }\n\n    writeGlobal(key, value) {\n        this.globalConfig[key] = value\n        this._configWrite(this.globalConfigPath, this.globalConfig)\n    }\n\n}\n\nconst config = new Config()\n\nmodule.exports = config\n"]}