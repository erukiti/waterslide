{"version":3,"sources":["../../../src/plugins/css/installer.js"],"names":["fs","require","path","utils","CssInstaller","constructor","operator","getInstaller","checkExistsNpm","install","helpText","readFileSync","join","__dirname","setInfo","jsInstaller","addDevPackage","webpackInstaller","addLoader","loader","options","limit","mimetype","name","module","exports"],"mappings":"AAAA;;;;AAEA,MAAMA,KAAKC,QAAQ,IAAR,CAAX;AACA,MAAMC,OAAOD,QAAQ,MAAR,CAAb;;AAEA,MAAM,EAACE,KAAD,KAAUF,QAAQ,kBAAR,CAAhB;;AAEA,MAAMG,YAAN,CAAmB;AACfC,gBAAYC,QAAZ,EAAsB;AAClB,aAAKA,QAAL,GAAgBA,QAAhB;AACH;;AAED,WAAOC,YAAP,CAAoBD,QAApB,EAA8B;AAC1B,YAAIH,MAAMK,cAAN,CAAqB,YAArB,CAAJ,EAAwC;AACpC,mBAAO,IAAP;AACH;AACD,eAAO,IAAI,IAAJ,CAASF,QAAT,CAAP;AACH;;AAEKG,WAAN,GAAgB;AAAA;;AAAA;AACZ,kBAAMC,WAAWV,GAAGW,YAAH,CAAgBT,KAAKU,IAAL,CAAUC,SAAV,EAAqB,UAArB,CAAhB,CAAjB;AACA,kBAAKP,QAAL,CAAcQ,OAAd,CAAsB,KAAtB,EAA6BJ,QAA7B;;AAEA,kBAAMK,cAAc,MAAM,MAAKT,QAAL,CAAcC,YAAd,CAA2B,IAA3B,CAA1B;AACAQ,wBAAYC,aAAZ,CAA0B,YAA1B;AACAD,wBAAYC,aAAZ,CAA0B,cAA1B;AACAD,wBAAYC,aAAZ,CAA0B,YAA1B;AACAD,wBAAYC,aAAZ,CAA0B,aAA1B;;AAEA,kBAAMC,mBAAmB,MAAM,MAAKX,QAAL,CAAcC,YAAd,CAA2B,SAA3B,CAA/B;AACAU,6BAAiBC,SAAjB,CAA2B,SAA3B,EAAsC,CAClC,EAACC,QAAQ,cAAT,EADkC,EAElC,EAACA,QAAQ,YAAT,EAFkC,CAAtC;AAIAF,6BAAiBC,SAAjB,CAA2B,sCAA3B,EAAmE,CAC/D;AACIC,wBAAQ,YADZ;AAEIC,yBAAS;AACLC,2BAAO,KADF;AAELC,8BAAU,uBAFL;AAGLC,0BAAM;AAHD;AAFb,aAD+D,CAAnE;AAUAN,6BAAiBC,SAAjB,CAA2B,mCAA3B,EAAgE,CAC5D;AACIC,wBAAQ,YADZ;AAEIC,yBAAS;AACLC,2BAAO,KADF;AAELC,8BAAU,0BAFL;AAGLC,0BAAM;AAHD;AAFb,aAD4D,CAAhE;AAUAN,6BAAiBC,SAAjB,CAA2B,mCAA3B,EAAgE,CAC5D;AACIC,wBAAQ,aADZ;AAEIC,yBAAS;AACLG,0BAAM;AADD;AAFb,aAD4D,CAAhE;AAQAN,6BAAiBC,SAAjB,CAA2B,mCAA3B,EAAgE,CAC5D;AACIC,wBAAQ,YADZ;AAEIC,yBAAS;AACLC,2BAAO,KADF;AAELC,8BAAU,eAFL;AAGLC,0BAAM;AAHD;AAFb,aAD4D,CAAhE;AA3CY;AAqDf;AAjEc;;AAoEnBC,OAAOC,OAAP,GAAiBrB,YAAjB","file":"installer.js","sourcesContent":["'use strict'\n\nconst fs = require('fs')\nconst path = require('path')\n\nconst {utils} = require('../../waterslide')\n\nclass CssInstaller {\n    constructor(operator) {\n        this.operator = operator\n    }\n\n    static getInstaller(operator) {\n        if (utils.checkExistsNpm('css-loader')) {\n            return null\n        }\n        return new this(operator)\n    }\n\n    async install() {\n        const helpText = fs.readFileSync(path.join(__dirname, 'help.txt'))\n        this.operator.setInfo('css', helpText)\n\n        const jsInstaller = await this.operator.getInstaller('js')\n        jsInstaller.addDevPackage('css-loader')\n        jsInstaller.addDevPackage('style-loader')\n        jsInstaller.addDevPackage('url-loader')\n        jsInstaller.addDevPackage('file-loader')\n\n        const webpackInstaller = await this.operator.getInstaller('webpack')\n        webpackInstaller.addLoader('\\\\.css$', [\n            {loader: 'style-loader'},\n            {loader: 'css-loader'},\n        ])\n        webpackInstaller.addLoader('\\\\.woff2?(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'url-loader',\n                options: {\n                    limit: 10000,\n                    mimetype: 'application/font-woff',\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n        webpackInstaller.addLoader('\\\\.ttf(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'url-loader',\n                options: {\n                    limit: 10000,\n                    mimetype: 'application/octet-stream',\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n        webpackInstaller.addLoader('\\\\.eot(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'file-loader',\n                options: {\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n        webpackInstaller.addLoader('\\\\.svg(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'url-loader',\n                options: {\n                    limit: 10000,\n                    mimetype: 'image/svg+xml',\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n    }\n}\n\nmodule.exports = CssInstaller\n"]}