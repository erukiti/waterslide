{"version":3,"sources":["../../../src/plugins/css/installer.js"],"names":["fs","require","path","utils","CssInstaller","operator","helpText","readFileSync","join","__dirname","setInfo","getInstaller","jsInstaller","addDevPackage","webpackInstaller","addLoader","loader","options","limit","mimetype","name","checkExistsNpm","module","exports"],"mappings":"AAAA;;;;;;;;AAEA,IAAMA,KAAKC,QAAQ,IAAR,CAAX;AACA,IAAMC,OAAOD,QAAQ,MAAR,CAAb;;eAEgBA,QAAQ,kBAAR,C;IAATE,K,YAAAA,K;;IAEDC,Y;AACF,0BAAYC,QAAZ,EAAsB;AAAA;;AAClB,aAAKA,QAAL,GAAgBA,QAAhB;AACH;;;;;;;;;;;AAUSC,wC,GAAWN,GAAGO,YAAH,CAAgBL,KAAKM,IAAL,CAAUC,SAAV,EAAqB,UAArB,CAAhB,C;;AACjB,qCAAKJ,QAAL,CAAcK,OAAd,CAAsB,KAAtB,EAA6BJ,QAA7B;;;uCAE0B,KAAKD,QAAL,CAAcM,YAAd,CAA2B,IAA3B,C;;;AAApBC,2C;;AACNA,4CAAYC,aAAZ,CAA0B,YAA1B;AACAD,4CAAYC,aAAZ,CAA0B,cAA1B;AACAD,4CAAYC,aAAZ,CAA0B,YAA1B;AACAD,4CAAYC,aAAZ,CAA0B,aAA1B;;;uCAE+B,KAAKR,QAAL,CAAcM,YAAd,CAA2B,SAA3B,C;;;AAAzBG,gD;;AACNA,iDAAiBC,SAAjB,CAA2B,SAA3B,EAAsC,CAClC,EAACC,QAAQ,cAAT,EADkC,EAElC,EAACA,QAAQ,YAAT,EAFkC,CAAtC;AAIAF,iDAAiBC,SAAjB,CAA2B,sCAA3B,EAAmE,CAC/D;AACIC,4CAAQ,YADZ;AAEIC,6CAAS;AACLC,+CAAO,KADF;AAELC,kDAAU,uBAFL;AAGLC,8CAAM;AAHD;AAFb,iCAD+D,CAAnE;AAUAN,iDAAiBC,SAAjB,CAA2B,mCAA3B,EAAgE,CAC5D;AACIC,4CAAQ,YADZ;AAEIC,6CAAS;AACLC,+CAAO,KADF;AAELC,kDAAU,0BAFL;AAGLC,8CAAM;AAHD;AAFb,iCAD4D,CAAhE;AAUAN,iDAAiBC,SAAjB,CAA2B,mCAA3B,EAAgE,CAC5D;AACIC,4CAAQ,aADZ;AAEIC,6CAAS;AACLG,8CAAM;AADD;AAFb,iCAD4D,CAAhE;AAQAN,iDAAiBC,SAAjB,CAA2B,mCAA3B,EAAgE,CAC5D;AACIC,4CAAQ,YADZ;AAEIC,6CAAS;AACLC,+CAAO,KADF;AAELC,kDAAU,eAFL;AAGLC,8CAAM;AAHD;AAFb,iCAD4D,CAAhE;;;;;;;;;;;;;;;;;;qCAlDgBf,Q,EAAU;AAC1B,gBAAIF,MAAMkB,cAAN,CAAqB,YAArB,CAAJ,EAAwC;AACpC,uBAAO,IAAP;AACH;AACD,mBAAO,IAAI,IAAJ,CAAShB,QAAT,CAAP;AACH;;;;;;AA0DLiB,OAAOC,OAAP,GAAiBnB,YAAjB","file":"installer.js","sourcesContent":["'use strict'\n\nconst fs = require('fs')\nconst path = require('path')\n\nconst {utils} = require('../../waterslide')\n\nclass CssInstaller {\n    constructor(operator) {\n        this.operator = operator\n    }\n\n    static getInstaller(operator) {\n        if (utils.checkExistsNpm('css-loader')) {\n            return null\n        }\n        return new this(operator)\n    }\n\n    async install() {\n        const helpText = fs.readFileSync(path.join(__dirname, 'help.txt'))\n        this.operator.setInfo('css', helpText)\n\n        const jsInstaller = await this.operator.getInstaller('js')\n        jsInstaller.addDevPackage('css-loader')\n        jsInstaller.addDevPackage('style-loader')\n        jsInstaller.addDevPackage('url-loader')\n        jsInstaller.addDevPackage('file-loader')\n\n        const webpackInstaller = await this.operator.getInstaller('webpack')\n        webpackInstaller.addLoader('\\\\.css$', [\n            {loader: 'style-loader'},\n            {loader: 'css-loader'},\n        ])\n        webpackInstaller.addLoader('\\\\.woff2?(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'url-loader',\n                options: {\n                    limit: 10000,\n                    mimetype: 'application/font-woff',\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n        webpackInstaller.addLoader('\\\\.ttf(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'url-loader',\n                options: {\n                    limit: 10000,\n                    mimetype: 'application/octet-stream',\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n        webpackInstaller.addLoader('\\\\.eot(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'file-loader',\n                options: {\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n        webpackInstaller.addLoader('\\\\.svg(\\\\?v=\\\\d+\\\\.\\\\d+\\\\.\\\\d+)?$', [\n            {\n                loader: 'url-loader',\n                options: {\n                    limit: 10000,\n                    mimetype: 'image/svg+xml',\n                    name: '[name].[ext]'\n                }\n            }\n        ])\n    }\n}\n\nmodule.exports = CssInstaller\n"]}