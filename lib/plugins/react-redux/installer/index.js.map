{"version":3,"sources":["../../../../src/plugins/react-redux/installer/index.js"],"names":["path","require","fs","Mustache","ReactReduxInstaller","constructor","operator","generator","generate","name","opts","prefix","basename","obj","render","inFile","outFile","opts2","fn","join","__dirname","templ","readFileSync","toString","content","writeFile","dir","dirname","type","getGenerator","replaceGenerator","getInstaller","install","babelInstaller","addPreset","addPlugin","jsInstaller","addDevPackage","addPackage","module","exports"],"mappings":"AAAA;;;;AAEA,MAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,MAAMC,KAAKD,QAAQ,IAAR,CAAX;AACA,MAAME,WAAWF,QAAQ,UAAR,CAAjB;;AAEA,MAAMG,mBAAN,CAA0B;AACtBC,gBAAYC,QAAZ,EAAsB;AAAA;;AAClB,aAAKA,QAAL,GAAgBA,QAAhB;;AAEA,cAAMC,YAAY;AACdC;AAAA,6CAAU,WAAOC,IAAP,EAAaC,OAAO,EAApB,EAA2B;AACjC,0BAAMC,SAASX,KAAKY,QAAL,CAAcH,IAAd,EAAoB,KAApB,CAAf;AACA,0BAAMI,MAAM,EAACF,MAAD,EAAZ;AACA,0BAAMG;AAAA,sDAAS,WAAOC,MAAP,EAAeC,OAAf,EAAwBC,QAAQ,EAAhC,EAAuC;AAClD,kCAAMC,KAAKlB,KAAKmB,IAAL,CAAUC,SAAV,EAAsB,GAAEL,MAAO,MAA/B,CAAX;AACA,kCAAMM,QAAQnB,GAAGoB,YAAH,CAAgBJ,EAAhB,EAAoBK,QAApB,EAAd;AACA,kCAAMC,UAAUrB,SAASW,MAAT,CAAgBO,KAAhB,EAAuBR,GAAvB,CAAhB;AACA,kCAAM,MAAKP,QAAL,CAAcmB,SAAd,CAAwBT,OAAxB,EAAiCQ,OAAjC,EAA0CP,KAA1C,CAAN;AACH,yBALK;;AAAA;AAAA;AAAA;AAAA,wBAAN;;AAOA,0BAAMS,MAAM1B,KAAK2B,OAAL,CAAalB,IAAb,CAAZ;AACA,0BAAMK,OAAO,YAAP,EAAsB,GAAEY,GAAI,aAA5B,CAAN;AACA,0BAAMZ,OAAO,YAAP,EAAsB,GAAEY,GAAI,IAAGf,MAAO,OAAtC,EAA8C,EAACiB,MAAM,MAAP,EAA9C,CAAN;AACA,0BAAMd,OAAO,WAAP,EAAqB,GAAEY,GAAI,IAAGf,MAAO,MAArC,EAA4CD,IAA5C,CAAN;AACA,0BAAMI,OAAO,aAAP,EAAuB,GAAEY,GAAI,cAA7B,CAAN;;AAEA,0BAAM,MAAKpB,QAAL,CAAcuB,YAAd,CAA2B,aAA3B,EAA0CrB,QAA1C,CAAoD,GAAEkB,GAAI,MAA1D,CAAN;AACH,iBAjBD;;AAAA;AAAA;AAAA;AAAA;AADc,SAAlB;;AAqBA,aAAKpB,QAAL,CAAcwB,gBAAd,CAA+B,SAA/B,EAA0CvB,SAA1C;AACH;;AAED,WAAOwB,YAAP,CAAoBzB,QAApB,EAA8B;AAC1B,eAAO,IAAI,IAAJ,CAASA,QAAT,CAAP;AACH;;AAEK0B,WAAN,GAAgB;AAAA;;AAAA;AACZ,kBAAMC,iBAAiB,MAAM,OAAK3B,QAAL,CAAcyB,YAAd,CAA2B,OAA3B,CAA7B;AACAE,2BAAeC,SAAf,CAAyB,OAAzB;AACAD,2BAAeE,SAAf,CAAyB,yBAAzB;;AAEA,kBAAMC,cAAc,MAAM,OAAK9B,QAAL,CAAcyB,YAAd,CAA2B,IAA3B,CAA1B;AACAK,wBAAYC,aAAZ,CAA0B,oBAA1B;AACAD,wBAAYC,aAAZ,CAA0B,yBAA1B;AACAD,wBAAYE,UAAZ,CAAuB,OAAvB;AACAF,wBAAYE,UAAZ,CAAuB,WAAvB;AACAF,wBAAYE,UAAZ,CAAuB,aAAvB;AACAF,wBAAYE,UAAZ,CAAuB,OAAvB;AAXY;AAYf;AA5CqB;;AA+C1BC,OAAOC,OAAP,GAAiBpC,mBAAjB","file":"index.js","sourcesContent":["'use strict'\n\nconst path = require('path')\nconst fs = require('fs')\nconst Mustache = require('mustache')\n\nclass ReactReduxInstaller {\n    constructor(operator) {\n        this.operator = operator\n\n        const generator = {\n            generate: async (name, opts = {}) => {\n                const prefix = path.basename(name, '.js')\n                const obj = {prefix}\n                const render = async (inFile, outFile, opts2 = {}) => {\n                    const fn = path.join(__dirname, `${inFile}.mst`)\n                    const templ = fs.readFileSync(fn).toString()\n                    const content = Mustache.render(templ, obj)\n                    await this.operator.writeFile(outFile, content, opts2)\n                }\n\n                const dir = path.dirname(name)\n                await render('actions.js', `${dir}/actions.js`)\n                await render('index.html', `${dir}/${prefix}.html`, {type: 'copy'})\n                await render('index.jsx', `${dir}/${prefix}.jsx`, opts)\n                await render('reducers.js', `${dir}/reducers.js`)\n\n                await this.operator.getGenerator('react-redux').generate(`${dir}/app`)\n            }\n        }\n\n        this.operator.replaceGenerator('browser', generator)\n    }\n\n    static getInstaller(operator) {\n        return new this(operator)\n    }\n\n    async install() {\n        const babelInstaller = await this.operator.getInstaller('babel')\n        babelInstaller.addPreset('react')\n        babelInstaller.addPlugin('babel-plugin-syntax-jsx')\n\n        const jsInstaller = await this.operator.getInstaller('js')\n        jsInstaller.addDevPackage('babel-preset-react')\n        jsInstaller.addDevPackage('babel-plugin-syntax-jsx')\n        jsInstaller.addPackage('react')\n        jsInstaller.addPackage('react-dom')\n        jsInstaller.addPackage('react-redux')\n        jsInstaller.addPackage('redux')\n    }\n}\n\nmodule.exports = ReactReduxInstaller\n"]}