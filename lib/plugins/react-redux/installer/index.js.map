{"version":3,"sources":["../../../../src/plugins/react-redux/installer/index.js"],"names":["path","require","fs","Mustache","ReactReduxInstaller","operator","generator","generate","name","opts","prefix","basename","obj","render","inFile","outFile","opts2","fn","join","__dirname","templ","readFileSync","toString","content","writeFile","dir","dirname","type","getGenerator","replaceGenerator","getInstaller","babelInstaller","addPreset","addPlugin","jsInstaller","addDevPackage","addPackage","module","exports"],"mappings":"AAAA;;;;;;;;AAEA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,IAAMC,KAAKD,QAAQ,IAAR,CAAX;AACA,IAAME,WAAWF,QAAQ,UAAR,CAAjB;;IAEMG,mB;AACF,iCAAYC,QAAZ,EAAsB;AAAA;;AAAA;;AAClB,aAAKA,QAAL,GAAgBA,QAAhB;;AAEA,YAAMC,YAAY;AACdC;AAAA,qEAAU,kBAAOC,IAAP;AAAA,wBAAaC,IAAb,uEAAoB,EAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AACAC,0CADA,GACSV,KAAKW,QAAL,CAAcH,IAAd,EAAoB,KAApB,CADT;AAEAI,uCAFA,GAEM,EAACF,cAAD,EAFN;;AAGAG,0CAHA;AAAA,8FAGS,iBAAOC,MAAP,EAAeC,OAAf;AAAA,gDAAwBC,KAAxB,uEAAgC,EAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AACLC,8DADK,GACAjB,KAAKkB,IAAL,CAAUC,SAAV,EAAwBL,MAAxB,UADA;AAELM,iEAFK,GAEGlB,GAAGmB,YAAH,CAAgBJ,EAAhB,EAAoBK,QAApB,EAFH;AAGLC,mEAHK,GAGKpB,SAASU,MAAT,CAAgBO,KAAhB,EAAuBR,GAAvB,CAHL;AAAA;AAAA,mEAIL,MAAKP,QAAL,CAAcmB,SAAd,CAAwBT,OAAxB,EAAiCQ,OAAjC,EAA0CP,KAA1C,CAJK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAHT;;AAAA,wDAGAH,MAHA;AAAA;AAAA;AAAA;;AAUAY,uCAVA,GAUMzB,KAAK0B,OAAL,CAAalB,IAAb,CAVN;AAAA;AAAA,2CAWAK,OAAO,YAAP,EAAwBY,GAAxB,iBAXA;;AAAA;AAAA;AAAA,2CAYAZ,OAAO,YAAP,EAAwBY,GAAxB,SAA+Bf,MAA/B,YAA8C,EAACiB,MAAM,MAAP,EAA9C,CAZA;;AAAA;AAAA;AAAA,2CAaAd,OAAO,WAAP,EAAuBY,GAAvB,SAA8Bf,MAA9B,WAA4CD,IAA5C,CAbA;;AAAA;AAAA;AAAA,2CAcAI,OAAO,aAAP,EAAyBY,GAAzB,kBAdA;;AAAA;AAAA;AAAA,2CAgBA,MAAKpB,QAAL,CAAcuB,YAAd,CAA2B,aAA3B,EAA0CrB,QAA1C,CAAsDkB,GAAtD,UAhBA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAV;;AAAA;AAAA;AAAA;;AAAA;AAAA;AADc,SAAlB;;AAqBA,aAAKpB,QAAL,CAAcwB,gBAAd,CAA+B,SAA/B,EAA0CvB,SAA1C;AACH;;;;;;;;;;;;uCAOgC,KAAKD,QAAL,CAAcyB,YAAd,CAA2B,OAA3B,C;;;AAAvBC,8C;;AACNA,+CAAeC,SAAf,CAAyB,OAAzB;AACAD,+CAAeE,SAAf,CAAyB,yBAAzB;;;uCAE0B,KAAK5B,QAAL,CAAcyB,YAAd,CAA2B,IAA3B,C;;;AAApBI,2C;;AACNA,4CAAYC,aAAZ,CAA0B,oBAA1B;AACAD,4CAAYC,aAAZ,CAA0B,yBAA1B;AACAD,4CAAYE,UAAZ,CAAuB,OAAvB;AACAF,4CAAYE,UAAZ,CAAuB,WAAvB;AACAF,4CAAYE,UAAZ,CAAuB,aAAvB;AACAF,4CAAYE,UAAZ,CAAuB,OAAvB;;;;;;;;;;;;;;;;;;qCAfgB/B,Q,EAAU;AAC1B,mBAAO,IAAI,IAAJ,CAASA,QAAT,CAAP;AACH;;;;;;AAiBLgC,OAAOC,OAAP,GAAiBlC,mBAAjB","file":"index.js","sourcesContent":["'use strict'\n\nconst path = require('path')\nconst fs = require('fs')\nconst Mustache = require('mustache')\n\nclass ReactReduxInstaller {\n    constructor(operator) {\n        this.operator = operator\n\n        const generator = {\n            generate: async (name, opts = {}) => {\n                const prefix = path.basename(name, '.js')\n                const obj = {prefix}\n                const render = async (inFile, outFile, opts2 = {}) => {\n                    const fn = path.join(__dirname, `${inFile}.mst`)\n                    const templ = fs.readFileSync(fn).toString()\n                    const content = Mustache.render(templ, obj)\n                    await this.operator.writeFile(outFile, content, opts2)\n                }\n\n                const dir = path.dirname(name)\n                await render('actions.js', `${dir}/actions.js`)\n                await render('index.html', `${dir}/${prefix}.html`, {type: 'copy'})\n                await render('index.jsx', `${dir}/${prefix}.jsx`, opts)\n                await render('reducers.js', `${dir}/reducers.js`)\n\n                await this.operator.getGenerator('react-redux').generate(`${dir}/app`)\n            }\n        }\n\n        this.operator.replaceGenerator('browser', generator)\n    }\n\n    static getInstaller(operator) {\n        return new this(operator)\n    }\n\n    async install() {\n        const babelInstaller = await this.operator.getInstaller('babel')\n        babelInstaller.addPreset('react')\n        babelInstaller.addPlugin('babel-plugin-syntax-jsx')\n\n        const jsInstaller = await this.operator.getInstaller('js')\n        jsInstaller.addDevPackage('babel-preset-react')\n        jsInstaller.addDevPackage('babel-plugin-syntax-jsx')\n        jsInstaller.addPackage('react')\n        jsInstaller.addPackage('react-dom')\n        jsInstaller.addPackage('react-redux')\n        jsInstaller.addPackage('redux')\n    }\n}\n\nmodule.exports = ReactReduxInstaller\n"]}