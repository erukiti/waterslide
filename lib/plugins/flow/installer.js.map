{"version":3,"sources":["../../../src/plugins/flow/installer.js"],"names":["fs","require","path","utils","FlowInstaller","operator","getInstaller","jsInstaller","addDevPackage","babelInstaller","addPreset","addTester","conf","readFileSync","join","__dirname","toString","writeFile","checkExistsNpm","checkExists","module","exports"],"mappings":"AAAA;;;;;;;;AAEA,IAAMA,KAAKC,QAAQ,IAAR,CAAX;AACA,IAAMC,OAAOD,QAAQ,MAAR,CAAb;;eAEgBA,QAAQ,kBAAR,C;IAATE,K,YAAAA,K;;IAEDC,a;AACF,2BAAYC,QAAZ,EAAsB;AAAA;;AAClB,aAAKA,QAAL,GAAgBA,QAAhB;AACH;;;;;;;;;;;;uCAY6B,KAAKA,QAAL,CAAcC,YAAd,CAA2B,IAA3B,C;;;AAApBC,2C;;AACNA,4CAAYC,aAAZ,CAA0B,UAA1B;AACAD,4CAAYC,aAAZ,CAA0B,YAA1B;AACAD,4CAAYC,aAAZ,CAA0B,mBAA1B;;;uCAE6B,KAAKH,QAAL,CAAcC,YAAd,CAA2B,OAA3B,C;;;AAAvBG,8C;;AACNA,+CAAeC,SAAf,CAAyB,MAAzB;;AAEA,qCAAKL,QAAL,CAAcM,SAAd,CAAwB,MAAxB,EAAgC,0BAAhC;;AAEA;AACA;;;AAGMC,oC,GAAOZ,GAAGa,YAAH,CAAgBX,KAAKY,IAAL,CAAUC,SAAV,EAAqB,YAArB,CAAhB,EAAoDC,QAApD,E;;uCACP,KAAKX,QAAL,CAAcY,SAAd,CAAwB,aAAxB,EAAuCL,IAAvC,C;;;;;;;;;;;;;;;;;;;oFAzBgBP,Q;;;;;+CAClBF,MAAMe,cAAN,CAAqB,UAArB,C;;;;;;;;uCACSb,SAASc,WAAT,CAAqB,aAArB,C;;;;;;;;;;;kEAEF,I;;;kEAEJ,IAAI,IAAJ,CAASd,QAAT,C;;;;;;;;;;;;;;;;;;;;;AAuBfe,OAAOC,OAAP,GAAiBjB,aAAjB","file":"installer.js","sourcesContent":["'use strict'\n\nconst fs = require('fs')\nconst path = require('path')\n\nconst {utils} = require('../../waterslide')\n\nclass FlowInstaller {\n    constructor(operator) {\n        this.operator = operator\n    }\n\n    static async getInstaller(operator) {\n        if (utils.checkExistsNpm('flow-bin')\n            || await operator.checkExists('.flowconfig')\n        ) {\n            return null\n        }\n        return new this(operator)\n    }\n\n    async install() {\n        const jsInstaller = await this.operator.getInstaller('js')\n        jsInstaller.addDevPackage('flow-bin')\n        jsInstaller.addDevPackage('flow-typed')\n        jsInstaller.addDevPackage('babel-preset-flow')\n\n        const babelInstaller = await this.operator.getInstaller('babel')\n        babelInstaller.addPreset('flow')\n\n        this.operator.addTester('flow', './node_modules/.bin/flow')\n\n        // const eslintInstaller = await this.operator.getInstaller('eslint')\n        // eslintInstaller.\n\n\n        const conf = fs.readFileSync(path.join(__dirname, 'flowconfig')).toString()\n        await this.operator.writeFile('.flowconfig', conf)\n    }\n}\n\nmodule.exports = FlowInstaller\n"]}