{"version":3,"sources":["../../../src/plugins/flow/installer.js"],"names":["fs","require","path","utils","FlowInstaller","constructor","operator","getInstaller","checkExistsNpm","checkExists","install","jsInstaller","addDevPackage","babelInstaller","addPlugin","conf","readFileSync","join","__dirname","toString","writeFile","module","exports"],"mappings":"AAAA;;;;AAEA,MAAMA,KAAKC,QAAQ,IAAR,CAAX;AACA,MAAMC,OAAOD,QAAQ,MAAR,CAAb;;AAEA,MAAM,EAACE,KAAD,KAAUF,QAAQ,kBAAR,CAAhB;;AAEA,MAAMG,aAAN,CAAoB;AAChBC,gBAAYC,QAAZ,EAAsB;AAClB,aAAKA,QAAL,GAAgBA,QAAhB;AACH;;AAED,WAAaC,YAAb,CAA0BD,QAA1B,EAAoC;AAAA;;AAAA;AAChC,gBAAIH,MAAMK,cAAN,CAAqB,UAArB,MACG,MAAMF,SAASG,WAAT,CAAqB,aAArB,CADT,CAAJ,EAEE;AACE,uBAAO,IAAP;AACH;AACD,mBAAO,UAASH,QAAT,CAAP;AANgC;AAOnC;;AAEKI,WAAN,GAAgB;AAAA;;AAAA;AACZ,kBAAMC,cAAc,MAAM,OAAKL,QAAL,CAAcC,YAAd,CAA2B,IAA3B,CAA1B;AACAI,wBAAYC,aAAZ,CAA0B,UAA1B;AACAD,wBAAYC,aAAZ,CAA0B,YAA1B;AACAD,wBAAYC,aAAZ,CAA0B,yCAA1B;;AAEA,kBAAMC,iBAAiB,MAAM,OAAKP,QAAL,CAAcC,YAAd,CAA2B,OAA3B,CAA7B;AACAM,2BAAeC,SAAf,CAAyB,4BAAzB;;AAEA;AACA;;;AAGA,kBAAMC,OAAOf,GAAGgB,YAAH,CAAgBd,KAAKe,IAAL,CAAUC,SAAV,EAAqB,YAArB,CAAhB,EAAoDC,QAApD,EAAb;AACA,kBAAM,OAAKb,QAAL,CAAcc,SAAd,CAAwB,aAAxB,EAAuCL,IAAvC,CAAN;AAdY;AAef;AA7Be;;AAgCpBM,OAAOC,OAAP,GAAiBlB,aAAjB","file":"installer.js","sourcesContent":["'use strict'\n\nconst fs = require('fs')\nconst path = require('path')\n\nconst {utils} = require('../../waterslide')\n\nclass FlowInstaller {\n    constructor(operator) {\n        this.operator = operator\n    }\n\n    static async getInstaller(operator) {\n        if (utils.checkExistsNpm('flow-bin')\n            || await operator.checkExists('.flowconfig')\n        ) {\n            return null\n        }\n        return new this(operator)\n    }\n\n    async install() {\n        const jsInstaller = await this.operator.getInstaller('js')\n        jsInstaller.addDevPackage('flow-bin')\n        jsInstaller.addDevPackage('flow-typed')\n        jsInstaller.addDevPackage('babel-plugin-transform-flow-strip-types')\n\n        const babelInstaller = await this.operator.getInstaller('babel')\n        babelInstaller.addPlugin('transform-flow-strip-types')\n\n        // const eslintInstaller = await this.operator.getInstaller('eslint')\n        // eslintInstaller.\n\n\n        const conf = fs.readFileSync(path.join(__dirname, 'flowconfig')).toString()\n        await this.operator.writeFile('.flowconfig', conf)\n    }\n}\n\nmodule.exports = FlowInstaller\n"]}